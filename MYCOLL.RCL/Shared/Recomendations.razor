@using MYCOLL.RCL.Entities
@using MYCOLL.RCL.Services
@using MYCOLL.RCL.Data.DTO
@using MYCOLL.RCL.Data.Interfaces
@inject CategoriaService CategoriaService
@inject IProdutoService ProdutoService
@inject AuthenticacaoService AuthenticacaoService

@if (produtos != null)
{
	<Carousel Title="Recomendados" Type="Big" Products="produtos" />
	<Carousel Title="Todos" Type="Small" Products="produtosTodos" />
}

@code {
	IEnumerable<Categoria>? categorias;
	List<ProdutoDTO>? produtos;
	List<ProdutoDTO>? produtosTodos;
	protected override async Task OnInitializedAsync()
	{
		categorias = await CategoriaService.GetCategorias();

		Random rnd = new Random();
		if (categorias is not null)
		{
			var count = categorias.Count();

		if(count > 0)
			{
				int number = rnd.Next(0, count);
				var categoriaSelecionada = categorias.ElementAt(number);
				produtos = await ProdutoService.GetProdutosByCategoria(categoriaSelecionada.Id);
			}
		}

		produtosTodos = await ProdutoService.GetProdutosAsync();

	}
}
